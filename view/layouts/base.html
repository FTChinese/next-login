<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  {% set iconUrl = "http://interactive.ftchinese.com/favicons" %}
  <link rel="apple-touch-icon" sizes="180x180" href="{{iconUrl}}/apple-touch-icon-180x180.png">
  <link rel="apple-touch-icon" sizes="152x152" href="{{iconUrl}}/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="120x120" href="{{iconUrl}}/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="{{iconUrl}}/apple-touch-icon-76x76.png">
  <link href="{{iconUrl}}/favicon.ico" type="image/x-icon" rel="shortcut icon"/>

  <title>{% block title %}用户中心{% endblock %} - FT中文网</title>
  
  {% if env.isProduction %}
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
  {% include "assets/style.html" %}
  {% else %}
  <link rel="stylesheet" href="/bootstrap/dist/css/bootstrap.css">
  <link rel="stylesheet" href="/style/main.css">
  {% endif %}
  
</head>
<body>
  <header class="navbar navbar-expand o-header">
    <div class="container">
      <a class="navbar-brand" href="http://www.ftchinese.com" target="__blank">FT中文网</a>

      {% if user %}
      <ul class="navbar-nav"> 

        <li class="nav-item dropdown d-none d-sm-inline">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">myFT</a>
    
          <div class="dropdown-menu dropdown-menu-right">
            <h6 class="dropdown-header">{{ user.getDisplayName() }}</h6>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="{{sitemap.profile}}">设置</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="{{sitemap.logout}}">退出</a>
          </div>
        </li>
    
        <li class="nav-item d-sm-none">
          <a class="nav-link" href="{{sitemap.profile}}">myFT</a>
        </li>
      </ul>
    
      <button class="o-toggler d-sm-none" type="button" data-toggle="collapse" data-target="#sidebarNav" aria-controls="#sidebarNav" aria-expanded="false" aria-label="Toggle navigation">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"></path></svg>
      </button>
      {% else %}
      <ul class="navbar-nav"> 
        <li class="nav-item">
          <a class="nav-link" href="{{sitemap.login}}">登录</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{{sitemap.signup}}">注册</a>
        </li>
      </ul>
      {% endif %}
    </div>
  </header>

  <main class="page-content" role="main">
    <div class="container">
      
      {% if errors.message %}
        <div class="alert alert-danger alert-dismissible fade show mt-3" role="alert">
          <span>{{errors.message}}</span>
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
        </div>
      {% endif %}

      {% block main %}
        {% if user and user.email and (not user.isVerified) %}
          <div class="alert alert-primary m-0" role="alert">
            <span>请验证您的登录邮箱。没有收到验证邮件？</span>
            <form
              class="d-inline"
              action="{{sitemap.requestVerification}}"
              method="post">
              <button
                data-disable-with="正在发送..."
                class="btn btn-link text-teal p-0">重新发送</button>
            </form>
          </div>
        {% endif %}

        <div class="row">
          <div class="col-sm-3">
            <div class="collapse d-sm-block mt-3" id="sidebarNav">
              <nav class="nav flex-column">
                {% for item in sideNav %}
                  <a class="nav-link{% if item.active %} active{% endif %}" href="{{item.href}}">{{item.text}}</a>
                {% endfor %}
                  <a class="nav-link d-sm-none" href="{{sitemap.profile}}">{{user.name}}</a>
                  <a class="nav-link d-sm-none" href="{{sitemap.logout}}">退出</a>
              </nav>
            </div>
            
          </div>
      
          <div class="col-sm-9">
            {% if alert %}
              <div class="alert alert-success alert-dismissible fade show mt-3" role="alert">
                <span>{{ alert.key | showAlert }}</span>
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
              </div>
            {% endif %}
            {% block content %}{% endblock %}
          </div>
        </div>

      {% endblock %}
    </div>
  </main>

  <footer class="o-footer o-footer--theme-dark">
    <div class="container">
      <div class="row">
        {% for group in env.footer %}
          <div class="col-sm-6 col-md-3 col-lg-2">
  
            <h6 class="o-footer__matrix-title">{{group.title}}</h6>
            <div class="o-footer__matrix-content">
  
              {% for item in group.items %}
              <a class="o-footer__matrix-link" href="{{item.href}}" target="_blank">{{item.text}}</a>
              {% endfor %}	
  
            </div>
  
          </div>
        {% endfor %}		
      </div>

      <div class="o-footer__copyright">
        <small>
          © FT中文网 {{env.year}}.
          <abbr title="Financial Times" aria-label="F T">FT</abbr> and ‘Financial Times’ are trademarks of The Financial Times Ltd.
        </small>
      </div>
      <div class="text-muted pb-3">
        <small>测试版 v{{env.version}}</small>
      </div>
    </div>
  </footer>

  {#
  <a href="{{ sitemap.feedback }}" class="feedback">
    <span>新版反馈</span>
  </a>
  #}

  <div class="global-spinner">
    <div class="spinner-border" role="status" aria-hidden="true">
      <span class="sr-only">加载中...</span>
    </div>
  </div>
  
  {% if env.isProduction %}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap.native/2.0.23/bootstrap-native-v4.min.js"></script>
  {% include "assets/script.html" %}

  {% else %}
  <script src="/bootstrap.native/dist/bootstrap-native-v4.js"></script>
  <script src="/script/main.js"></script>
  {% endif %}
</body>
</html>
